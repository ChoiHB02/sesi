#FireBase 기능인 Auth, Message SDK를 추가하여 활성화하는 방법 

---

<aside>
💡 **HEADER**

</aside>

---

# 개요

---

에셋 파일 안의 데이터를 빼는 방법과 데이터를 순서대로 엑셀에 넣는 것에 대한 문서

<aside>
⚠️ 작성시기 2023년 03월

</aside>

<aside>
⚠️ Visual Studio 2022, Excel 2013에서 진행되었습니다.

</aside>

---

* 사용 목적
  1. ASSET 확장자 파일에서 필요한 값들을 뽑아서 엑셀에 넣어서 정렬시키는 것.

* 구성 요소
    1.  데이터를 뽑을 에셋 파일이 담긴 폴더
    2.	데이터를 엑셀로 뽑아내서 저장할 폴더 


## 1) 준비 작업

1. 먼저 프로젝트를 만들기 전에 Visual Studio Installer에 들어갑니다.
2. 워크로드 칸에 '.NET 데스크콥 개발'이라고 써져 있는 칸을 클릭하고 설치해주면, 준비가 끝납니다.
---------------------------------------------------------------------------------------------------------------------------------------------

## 2) 코드 사용 방법

1. 먼저 Visual Studio에서 '새 프로젝트를 만들기'를 클릭해줍니다. 
2. 설치를 해줄 프로젝트는 '콘솔 앱(.NET Framework)'(C#) 이니 검색을 하거나 스크롤을 내려서 찾습니다.
3. 이후에 새 창이 나오는데 이 글 밑에 있는 코드를 붙여넣으면 됩니다.
4. 이 코드를 하기 전 Visual Studio 2022에서는 프로젝트->참조 추가->COM->검색에서 'Excel' 타이핑 해주면 Microft Excel 15.0 Object Library가 나오는데 왼쪽 상자를 클릭하여 추가하고 확인을 눌러줘야 합니다.
5. 마지막으로 에셋파일이 들어있는 폴더의 경로를 찾고 경로의 길이를 재야합니다.
6. 경로를 찾았다면 세 개의 변수를 바꿔줘야 합니다.
--------------------------------------------------------------------------------------------------------------------------------------------- 
 ### 첫 번째 
 ```C#
string directoryPath = @"엑셀로 바꿀 폴더의 ";
```
 - 이 변수는 엑셀로 바꿀 폴더의 경로를 정해줘야 합니다.
 - 그렇기에 폴더로 가서 경로를 복사해주고 쌍따옴표 안에 붙여넣기를 해주면 됩니다.

 ### 두 번째 
```C#
 Directory.CreateDirectory(path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
  path[4] + "\\" + path[5]);
```
 - 이 변수는 디렉토리를 따로 하나 복사해서 엑셀로 바꾼 파일들을 넣습니다. 
 - \마다 나눴기 때문에 길이에 따라 수정을 해줘야 합니다.
 - 예를 들어보자면 C:\Users\SESI\Downloads\homework\testFinal 에 파일이 담겨 있는 폴더들이 있으면 
 - C:이 path[0]이고 User가 path[1], SEST가 path[2]. 이런 식으로 길이에 따라 넣으면 되니 이건 path[5]까지 넣으면 될 것 같습니다.

 ### 세 번째 
```C#
 string savePath = path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
  path[4] + "\\" + path[5] + "\\" + fileName[0];
```
 - 엑셀 파일을 저장하는 경로 설정하는 변수이기에.
 - 아까 폴더의 경로를 설정해왔으니 그걸 복사 붙여넣기를 하고 마지막에 + path[5] + "\\" + fileName[0] 를 넣으면 될 것 같습니다. 
 - 이렇게 하면 각 에셋 파일이 모두 엑셀 파일로 바뀌어진 광경을 볼 수 있습니다.

---------------------------------------------------------------------------------------------------------------------------------------------
 ##  3) 네임스페이스
```C#
using Excel = Microsoft.Office.Interop.Excel;
using Microsoft.Office.Interop.Excel;
```
이 두 개는 C# 코드 내에서 Excel 통합 문서, 워크시트, 셀 및 기타 관련 개체에 액세스하고 조작할 수 있습니다.
먼저 엑셀을 만들기 위해선 이 두 개의 네임스페이스가 중요합니다. 

- 첫 번째 줄은 네임스페이스에 대한 별칭 "Excel"을 만듭니다. 
이렇게 하면 코드의 다른 네임스페이스 또는 클래스와의 이름 충돌을 방지할 수 있습니다.
- 두 번째 줄은 C# 코드에서 Excel 작업을 자동화하는 데 사용할 수 있는 모든 클래스, 인터페이스 및 열거형을 포함하는 전체 Excel 개체 모델을 가져옵니다.
---------------------------------------------------------------------------------------------------------------------------------------------

#### 나머지 네임 스페이스
 - System.Text: 텍스트를 인코딩, 디코딩 및 조작하기 위한 형식과 클래스를 제공합니다.
 - System.Threading.Tasks: TAP(작업 기반 비동기 패턴)를 사용하여 비동기 코드를 작성하기 위한 형식과 클래스를 제공합니다.
 - System.Runtime.InteropServices: C# 코드에서 DLL 함수를 호출하는 것과 같이 비관리 코드와 상호 작용하기 위한 형식 및 클래스를 제공합니다.
 - System.Data.Common: 공용 ADO.NET 인터페이스를 구현하는 데이터 공급자와 함께 작업하기 위한 형식과 클래스를 제공합니다.
---------------------------------------------------------------------------------------------------------------------------------------------

 ##  4) 중요 코드
 
 ### 4.1) 
```C#
string[] lines = File.ReadAllLines(excelFilePath);
 for (int i = 2; i <= count; i++) 
     {
     }
```
* 이 두 코드는 파일을 가져왔을 때 파일의 텍스트를 싹 다 읽어오고
* 열이 2번째부터 출력되기 때문에 i를 2로 설정했습니다.

 ### 4.2) 
```C#
Application excel = new Application();
Workbook workbook = excel.Workbooks.Add();
Worksheet worksheet = workbook.Sheets[1]; //storytimeline

workbook.SaveAs(savePath);
workbook.Close();
excel.Quit();

```
* Excel을 자동화하는 데 사용할 수 있는 Excel 응용 프로그램의 새 인스턴스가 만들고 통합문서와 워크 시트를 만듭니다.
* 후에 작업이 끝나면 엑셀을 전체적으로 이 코드는 Excel 통합 문서를 지정된 파일 경로에 저장한 다음 연결된 모든 리소스를 적절하게 해제하여 통합 문서와 응용 프로그램이 완전히 닫히고 메모리 누수 또는 기타 문제가 발생하지 않도록 합니다.


 ### 4.3) 
```C#
if (line.Contains(variable))
    {
    }
```
* 이 함수를 통해 텍스트에서 줄마다 string 변수 variable이 정의된 값이 포함된 줄을 읽어옵니다.


 ### 4.4) 
```C#
ReleaseExcelObject()
```
* 이러한 코드 줄은 Excel 개체와 연결된 모든 리소스가 제대로 해제되도록 하도록 하며, 이는 메모리 누수 및 기타 문제를 방지합니다.

